<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cybercrime Puzzle Game</title>
<style>
body {
  margin: 0; padding: 0; height: 100vh;
  display: flex; justify-content: center; align-items: center;
  background: url("assets/images/background.png") no-repeat center center fixed;
  background-size: cover;
  font-family: Arial, sans-serif; color: #fff;
}
#puzzleBtn { background: #00c4ff; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-size: 20px; font-weight: bold; color: #fff; box-shadow: 0 4px 12px rgba(0,0,0,0.5); transition: transform 0.2s; }
#puzzleBtn:hover { transform: scale(1.05); background: #0080aa; }
#puzzleModal {
  display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.9); display: flex; align-items: center; justify-content: center;
}
#puzzleContent {
  background: rgba(20,20,20,0.95); padding: 25px; border-radius: 16px;
  max-width: 800px; width: 90%; text-align: center; box-shadow: 0 8px 16px rgba(0,0,0,0.6);
  overflow-y: auto; max-height: 90vh;
}
h2 { margin-top: 0; color: #00c4ff; }
button.game-option, button.quiz-option { display: block; margin: 10px auto; padding: 12px; background: #333; border-radius: 8px; cursor: pointer; width: 80%; border: 2px solid transparent; transition: 0.3s; color: #fff; font-size: 18px; }
button.game-option:hover, button.quiz-option:hover { background: #555; border-color: #00c4ff; }
.close-btn { background: #ff4444; color: #fff; border: none; padding: 10px 18px; margin-top: 20px; cursor: pointer; border-radius: 6px; font-weight: bold; }
#levelInfo { margin-bottom: 15px; font-size: 18px; color: #ffcc00; }
#puzzleArea { margin-top: 15px; }
#malwareMaze { display: grid; gap: 2px; justify-content: center; margin-top: 10px; }
.cell { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border: 1px solid #555; font-size: 18px; cursor: pointer; }
.cell.safe { background: #222; }
.cell.malware { background: red; color: white; }
.cell.packet { background: #00ff00; color: black; }
</style>
</head>
<body>

<div id="puzzleBtn">üß© Start Cybercrime Puzzle</div>

<div id="puzzleModal">
  <div id="puzzleContent">
    <h2>Cybercrime Game</h2>
    <div id="gameMenu">
      <p>Select a game mode:</p>
      <button class="game-option" onclick="startQuiz()">Knowledgeable Quiz</button>
      <button class="game-option" onclick="startPasswordPuzzle()">Password Puzzle</button>
      <button class="game-option" onclick="startPhishingPuzzle()">Phishing Detective</button>
      <button class="game-option" onclick="startMalwareMaze()">Malware Maze</button>
    </div>
    <p id="levelInfo"></p>
    <div id="puzzleArea"></div>
    <button class="close-btn" onclick="closePuzzle()">Close</button>
  </div>
</div>

<script>
const puzzleBtn = document.getElementById("puzzleBtn");
const puzzleModal = document.getElementById("puzzleModal");
const gameMenu = document.getElementById("gameMenu");
const puzzleArea = document.getElementById("puzzleArea");
const levelInfo = document.getElementById("levelInfo");

let currentGame = "";
let currentLevel = 1;

puzzleBtn.addEventListener("click", () => {
  gameMenu.style.display = "block";
  puzzleArea.innerHTML = "";
  levelInfo.innerHTML = "";
  puzzleModal.style.display = "flex";
});

// --- QUIZ PLACEHOLDER ---
function startQuiz() {
  currentGame = "quiz";
  gameMenu.style.display = "none";
  puzzleArea.innerHTML = "<p>Knowledgeable Quiz Coming Soon!</p>";
}

// --- PASSWORD PUZZLE ---
function startPasswordPuzzle() {
  currentGame = "password";
  currentLevel = 1;
  gameMenu.style.display = "none";
  loadPasswordLevel();
}

function loadPasswordLevel() {
  levelInfo.textContent = `Password Puzzle - Level ${currentLevel}`;
  const levelPasswords = {
    1: ["apple", "cyber", "matrix"],
    2: ["P@ss123", "Hack2024", "Safe!42"],
    3: ["Cyb3r$afe!", "P@ssw0rd!2025", "S3cur3#Data"],
    4: ["D@t@Prot3ct!", "S3cur3P@ss!", "C0mpuT3r$afe"],
    5: ["N3tw0rk!Sec#2025", "M@lic1ous0v3r!", "Cr!pt0Safe!42"]
  };
  const passwords = levelPasswords[currentLevel];
  const password = passwords[Math.floor(Math.random()*passwords.length)];
  const scrambled = password.split('').sort(()=>0.5-Math.random()).join('');
  puzzleArea.innerHTML = `<p>Scrambled: <b>${scrambled}</b></p>
    <input type="text" id="pwdInput" placeholder="Enter password" />
    <button onclick="checkPasswordLevel('${password}')">Submit</button>
    <p id="pwdResult"></p>`;
}

function checkPasswordLevel(correct) {
  const input = document.getElementById("pwdInput").value;
  const res = document.getElementById("pwdResult");
  if(input === correct){
    res.textContent = "‚úÖ Correct!";
    res.style.color = "lightgreen";
    if(currentLevel<5){
      puzzleArea.innerHTML += `<button onclick="nextPasswordLevel()">‚û°Ô∏è Next Level</button>`;
    } else {
      puzzleArea.innerHTML += `<p>üèÜ You completed all Password Puzzle levels!</p>`;
    }
  } else {
    res.textContent = "‚ùå Incorrect. Try again.";
    res.style.color = "tomato";
  }
}

function nextPasswordLevel(){
  currentLevel++;
  loadPasswordLevel();
}

// --- PHISHING DETECTIVE ---
function startPhishingPuzzle() {
  currentGame = "phishing";
  currentLevel = 1;
  gameMenu.style.display = "none";
  loadPhishingLevel();
}

function loadPhishingLevel() {
  levelInfo.textContent = `Phishing Detective - Level ${currentLevel}`;
  const levelEmails = {
    1: [
      {text:"Bank Alert: Click here", phishing:true},
      {text:"School newsletter", phishing:false}
    ],
    2: [
      {text:"Paypal: Unauthorized login attempt", phishing:true},
      {text:"Company HR update", phishing:false}
    ],
    3: [
      {text:"Secure your account at bank-secure.com", phishing:true},
      {text:"Official tax notice", phishing:false}
    ],
    4: [
      {text:"Confirm payment info at paypal-secure.com", phishing:true},
      {text:"Team project update", phishing:false}
    ],
    5: [
      {text:"Login to secure-email.com to update account", phishing:true},
      {text:"Company newsletter", phishing:false}
    ]
  };
  const emails = levelEmails[currentLevel];
  const email = emails[Math.floor(Math.random()*emails.length)];
  puzzleArea.innerHTML = `<p>${email.text}</p>
    <button onclick="checkEmailLevel(true, ${email.phishing})">Phishing</button>
    <button onclick="checkEmailLevel(false, ${email.phishing})">Safe</button>
    <p id="emailResult"></p>`;
}

function checkEmailLevel(selected, correct){
  const res = document.getElementById("emailResult");
  if(selected === correct){
    res.textContent = "‚úÖ Correct!";
    res.style.color = "lightgreen";
    if(currentLevel<5){
      puzzleArea.innerHTML += `<button onclick="nextPhishingLevel()">‚û°Ô∏è Next Level</button>`;
    } else {
      puzzleArea.innerHTML += `<p>üèÜ You completed all Phishing Detective levels!</p>`;
    }
  } else {
    res.textContent = "‚ùå Wrong!";
    res.style.color = "tomato";
  }
}

function nextPhishingLevel(){
  currentLevel++;
  loadPhishingLevel();
}

// --- MALWARE MAZE ---
function startMalwareMaze() {
  currentGame = "maze";
  currentLevel = 1;
  gameMenu.style.display = "none";
  loadMazeLevel();
}

function loadMazeLevel() {
  levelInfo.textContent = `Malware Maze - Level ${currentLevel}`;
  const sizes = {1:6, 2:7, 3:8, 4:9, 5:10};
  const danger = {1:0.2, 2:0.25, 3:0.3, 4:0.35, 5:0.4};
  const size = sizes[currentLevel];
  const malwareChance = danger[currentLevel];

  const maze = []; const packet = {x:0,y:0}; const exit = {x:size-1,y:size-1};
  for(let i=0;i<size;i++){
    maze[i]=[];
    for(let j=0;j<size;j++){
      maze[i][j] = (Math.random()<malwareChance && !(i===0 && j===0) && !(i===exit.x && j===exit.y)) ? 'malware':'safe';
    }
  }

  function renderMaze(){
    puzzleArea.innerHTML = `<div id="malwareMaze" style="display:grid;grid-template-columns:repeat(${size},40px);gap:2px;"></div>`;
    const grid = document.getElementById("malwareMaze");
    for(let i=0;i<size;i++){
      for(let j=0;j<size;j++){
        const cell = document.createElement("div");
        cell.className = 'cell ' + maze[i][j];
        if(i===packet.x && j===packet.y) cell.classList.add('packet');
        if(i===exit.x && j===exit.y) cell.textContent = 'üèÅ';
        grid.appendChild(cell);
      }
    }
  }

  function move(dx,dy){
    const nx=packet.x+dx; const ny=packet.y+dy;
    if(nx<0||ny<0||nx>=size||ny>=size) return;
    packet.x=nx; packet.y=ny;
    if(maze[nx][ny]==='malware'){
      alert("üí• You hit malware! Try again.");
      packet.x=0; packet.y=0;
    } else if(packet.x===exit.x && packet.y===exit.y){
      alert("üèÜ You reached the exit!");
      if(currentLevel<5){
        currentLevel++;
        loadMazeLevel();
      } else {
        alert("üèÜ You completed all Malware Maze levels!");
      }
    }
    renderMaze();
  }

  renderMaze();
  document.onkeydown = (e)=>{
    if(e.key==='ArrowUp') move(-1,0);
    if(e.key==='ArrowDown') move(1,0);
    if(e.key==='ArrowLeft') move(0,-1);
    if(e.key==='ArrowRight') move(0,1);
  }
}

// --- CLOSE PUZZLE ---
function closePuzzle() {
  puzzleModal.style.display = "none";
  document.onkeydown = null;
}
</script>

</body>
</html>
